
/*****
*
* Copyright (C) 2004-2016 CS-SI. All Rights Reserved.
* Author: Yoann Vandoorselaere <yoann.v@libiodef-ids.com>
* Author: Nicolas Delon <nicolas.delon@libiodef-ids.com>
*
* This file is part of the LibIodef library.
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation; either version 2, or (at your option)
* any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License along
* with this program; if not, write to the Free Software Foundation, Inc.,
* 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
*
*****/

/* Auto-generated by the GenerateIODEFMessagePrintC package */

#include "config.h"
#include "libmissing.h"

#include <stdio.h>

#include "iodef.h"
#include "iodef-tree-wrap.h"
#include "iodef-document-print.h"


static int indent = 0;

static void print_indent(libiodef_io_t *fd)
{
        int cnt;

        for ( cnt = 0; cnt < indent; cnt++ )
                libiodef_io_write(fd, " ", 1);
}



static void print_string(libiodef_string_t *string, libiodef_io_t *fd)
{
        if ( libiodef_string_is_empty(string) )
                libiodef_io_write(fd, "<empty>", 7);
        else
                libiodef_io_write(fd, libiodef_string_get_string(string), libiodef_string_get_len(string));
}



static void print_uint8(uint8_t i, libiodef_io_t *fd)
{
        int len;
        char buf[sizeof("255")];

        /*
         * %hh convertion specifier is not portable.
         */
        len = snprintf(buf, sizeof(buf), "%u", (unsigned int) i);
        libiodef_io_write(fd, buf, len);
}


static void print_uint16(uint16_t i, libiodef_io_t *fd)
{
        int len;
        char buf[sizeof("65535")];

        len = snprintf(buf, sizeof(buf), "%hu", i);
        libiodef_io_write(fd, buf, len);
}


static void print_int32(int32_t i, libiodef_io_t *fd)
{
        int len;
        char buf[sizeof("4294967296")];

        len = snprintf(buf, sizeof(buf), "%d", i);
        libiodef_io_write(fd, buf, len);
}


static void print_uint32(uint32_t i, libiodef_io_t *fd)
{
        int len;
        char buf[sizeof("4294967296")];

        len = snprintf(buf, sizeof(buf), "%u", i);
        libiodef_io_write(fd, buf, len);
}



static void print_uint64(uint64_t i, libiodef_io_t *fd)
{
        int len;
        char buf[sizeof("18446744073709551616")];

        len = snprintf(buf, sizeof(buf), "%" LIBIODEF_PRIu64, i);
        libiodef_io_write(fd, buf, len);
}



static void print_float(float f, libiodef_io_t *fd)
{
        int len;
        char buf[32];

        len = snprintf(buf, sizeof(buf), "%f", f);
        libiodef_io_write(fd, buf, len);
}




static void print_time(iodef_time_t *t, libiodef_io_t *fd)
{
        int len;
        time_t _time;
        struct tm _tm;
        char tmp[32], buf[128];

        _time = iodef_time_get_sec(t) + iodef_time_get_gmt_offset(t);

        if ( ! gmtime_r(&_time, &_tm) )
                return;

        len = strftime(tmp, sizeof(tmp), "%d/%m/%Y %H:%M:%S", &_tm);
        if ( len == 0 )
                return;

        len = snprintf(buf, sizeof(buf), "%s.%u %+.2d:%.2d",
                       tmp, iodef_time_get_usec(t), iodef_time_get_gmt_offset(t) / 3600,
                       iodef_time_get_gmt_offset(t) % 3600 / 60);

        libiodef_io_write(fd, buf, len);
}



/* print data as a string */

static int print_data(iodef_data_t *data, libiodef_io_t *fd)
{
        int ret;
        libiodef_string_t *out;

        ret = libiodef_string_new(&out);
        if ( ret < 0 )
                return ret;

        ret = iodef_data_to_string(data, out);
        if ( ret < 0 ) {
                libiodef_string_destroy(out);
                return ret;
        }

        libiodef_io_write(fd, libiodef_string_get_string(out), libiodef_string_get_len(out));
        libiodef_string_destroy(out);

        return 0;
}



static void print_enum(const char *s, int i, libiodef_io_t *fd)
{
        int len;
        char buf[512];

        if ( ! s )
                s = "<invalid enum value>";

        len = snprintf(buf, sizeof(buf), "%s (%d)", s, i);
        libiodef_io_write(fd, buf, len);
}


/**
 * iodef_additional_data_print:
 * @ptr: Pointer to an iodef_additional_data_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_additional_data_print(iodef_additional_data_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_additional_data_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_additional_data_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_additional_data_get_type(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "type: ", sizeof("type: ") - 1);
                        print_enum(iodef_additional_data_type_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "formatid: ";

                field = iodef_additional_data_get_formatid(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "meaning: ";

                field = iodef_additional_data_get_meaning(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_dtype: ";

                field = iodef_additional_data_get_ext_dtype(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                iodef_data_t *field;
                const char tmp[] = "data: ";

                field = iodef_additional_data_get_data(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);

                        if ( iodef_additional_data_get_type(ptr) != IODEF_ADDITIONAL_DATA_TYPE_NTPSTAMP )
                                print_data(field, fd);

                        else {
                                int ret;
                                uint64_t i;
                                libiodef_string_t *out;

                                ret = libiodef_string_new(&out);
                                if ( ret < 0 )
                                        return;

                                i = iodef_data_get_int(field);
                                ret = libiodef_string_sprintf(out, "0x%" LIBIODEF_PRIx32 ".0x%" LIBIODEF_PRIx32 "", (uint32_t) (i >> 32), (uint32_t) i);
                                if ( ret < 0 ) {
                                        libiodef_string_destroy(out);
                                        return;
                                }

                                libiodef_io_write(fd, libiodef_string_get_string(out), libiodef_string_get_len(out));
                                libiodef_string_destroy(out);
                        }
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_email_print:
 * @ptr: Pointer to an iodef_email_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_email_print(iodef_email_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_email_get_meaning(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "meaning: ", sizeof("meaning: ") - 1);
                        print_enum(iodef_email_meaning_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "email: ";

                field = iodef_email_get_email(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_registry_handle_print:
 * @ptr: Pointer to an iodef_registry_handle_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_registry_handle_print(iodef_registry_handle_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_registry_handle_get_registry(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "registry: ", sizeof("registry: ") - 1);
                        print_enum(iodef_registry_handle_registry_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_registry: ";

                field = iodef_registry_handle_get_ext_registry(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_postal_address_print:
 * @ptr: Pointer to an iodef_postal_address_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_postal_address_print(iodef_postal_address_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_postal_address_get_lang(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "lang: ", sizeof("lang: ") - 1);
                        print_enum(iodef_postal_address_lang_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_postal_address_get_meaning(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "meaning: ", sizeof("meaning: ") - 1);
                        print_enum(iodef_postal_address_meaning_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_contact_print:
 * @ptr: Pointer to an iodef_contact_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_contact_print(iodef_contact_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_additional_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_contact_get_next_additional_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "additional_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_additional_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "fax: ";

                field = iodef_contact_get_fax(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_contact_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_contact_get_next_telephone(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "telephone(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_registry_handle_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_contact_get_next_registry_handle(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "registry_handle(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_registry_handle_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_contact_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_contact_get_next_contact(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "contact(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_contact_print(elem, fd);

                        cnt++;
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "contact_name: ";

                field = iodef_contact_get_contact_name(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "timezone: ";

                field = iodef_contact_get_timezone(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                iodef_postal_address_t *field;

                field = iodef_contact_get_postal_address(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "postal_address:\n", sizeof("postal_address:\n") - 1);
                        iodef_postal_address_print(field, fd);
                }
        }

        {
                char buf[128];
                iodef_email_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_contact_get_next_email(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "email(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_email_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_contact_get_type(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "type: ", sizeof("type: ") - 1);
                        print_enum(iodef_contact_type_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_contact_get_role(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "role: ", sizeof("role: ") - 1);
                        print_enum(iodef_contact_role_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_type: ";

                field = iodef_contact_get_ext_type(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_role: ";

                field = iodef_contact_get_ext_role(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_contact_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_contact_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_incident_id_print:
 * @ptr: Pointer to an iodef_incident_id_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_incident_id_print(iodef_incident_id_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                libiodef_string_t *field;
                const char tmp[] = "instance: ";

                field = iodef_incident_id_get_instance(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "name: ";

                field = iodef_incident_id_get_name(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_incident_id_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_incident_id_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_alternative_id_print:
 * @ptr: Pointer to an iodef_alternative_id_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_alternative_id_print(iodef_alternative_id_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_incident_id_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_alternative_id_get_next_incident_id(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "incident_id(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_incident_id_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_alternative_id_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_alternative_id_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_related_activity_print:
 * @ptr: Pointer to an iodef_related_activity_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_related_activity_print(iodef_related_activity_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_related_activity_get_next_url(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "url(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_incident_id_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_related_activity_get_next_incident_id(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "incident_id(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_incident_id_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_related_activity_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_related_activity_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_history_item_print:
 * @ptr: Pointer to an iodef_history_item_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_history_item_print(iodef_history_item_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_additional_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_history_item_get_next_additional_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "additional_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_additional_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_incident_id_t *field;

                field = iodef_history_item_get_incident_id(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "incident_id:\n", sizeof("incident_id:\n") - 1);
                        iodef_incident_id_print(field, fd);
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_history_item_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                iodef_contact_t *field;

                field = iodef_history_item_get_contact(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "contact:\n", sizeof("contact:\n") - 1);
                        iodef_contact_print(field, fd);
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "date_time: ";

                field = iodef_history_item_get_date_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_history_item_get_action(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "action: ", sizeof("action: ") - 1);
                        print_enum(iodef_history_item_action_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_history_item_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_history_item_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_action: ";

                field = iodef_history_item_get_ext_action(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_history_print:
 * @ptr: Pointer to an iodef_history_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_history_print(iodef_history_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_history_item_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_history_get_next_history_item(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "history_item(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_history_item_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_history_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_history_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_expectation_print:
 * @ptr: Pointer to an iodef_expectation_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_expectation_print(iodef_expectation_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                iodef_time_t *field;
                const char tmp[] = "end_time: ";

                field = iodef_expectation_get_end_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_expectation_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "start_time: ";

                field = iodef_expectation_get_start_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                iodef_contact_t *field;

                field = iodef_expectation_get_contact(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "contact:\n", sizeof("contact:\n") - 1);
                        iodef_contact_print(field, fd);
                }
        }

        {
                int i = iodef_expectation_get_action(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "action: ", sizeof("action: ") - 1);
                        print_enum(iodef_expectation_action_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_expectation_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_expectation_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_action: ";

                field = iodef_expectation_get_ext_action(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_expectation_get_severity(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "severity: ", sizeof("severity: ") - 1);
                        print_enum(iodef_expectation_severity_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_record_pattern_print:
 * @ptr: Pointer to an iodef_record_pattern_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_record_pattern_print(iodef_record_pattern_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_record_pattern_get_offsetunit(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "offsetunit: ", sizeof("offsetunit: ") - 1);
                        print_enum(iodef_record_pattern_offsetunit_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                uint32_t *field;
                const char tmp[] = "instance: ";

                field = iodef_record_pattern_get_instance(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_uint32(*field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_type: ";

                field = iodef_record_pattern_get_ext_type(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                uint32_t *field;
                const char tmp[] = "offset: ";

                field = iodef_record_pattern_get_offset(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_uint32(*field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_offsetunit: ";

                field = iodef_record_pattern_get_ext_offsetunit(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_record_pattern_get_type(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "type: ", sizeof("type: ") - 1);
                        print_enum(iodef_record_pattern_type_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_record_item_print:
 * @ptr: Pointer to an iodef_record_item_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_record_item_print(iodef_record_item_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_record_item_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_record_item_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_record_item_get_dtype(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "dtype: ", sizeof("dtype: ") - 1);
                        print_enum(iodef_record_item_dtype_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "formatid: ";

                field = iodef_record_item_get_formatid(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "meaning: ";

                field = iodef_record_item_get_meaning(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_dtype: ";

                field = iodef_record_item_get_ext_dtype(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                iodef_data_t *field;
                const char tmp[] = "data: ";

                field = iodef_record_item_get_data(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_data(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_application_print:
 * @ptr: Pointer to an iodef_application_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_application_print(iodef_application_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                libiodef_string_t *field;
                const char tmp[] = "url: ";

                field = iodef_application_get_url(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "vendor: ";

                field = iodef_application_get_vendor(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "name: ";

                field = iodef_application_get_name(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "family: ";

                field = iodef_application_get_family(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "swid: ";

                field = iodef_application_get_swid(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "patch: ";

                field = iodef_application_get_patch(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "version: ";

                field = iodef_application_get_version(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "configid: ";

                field = iodef_application_get_configid(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_record_data_print:
 * @ptr: Pointer to an iodef_record_data_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_record_data_print(iodef_record_data_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                iodef_additional_data_t *field;

                field = iodef_record_data_get_additional_data(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "additional_data:\n", sizeof("additional_data:\n") - 1);
                        iodef_additional_data_print(field, fd);
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_record_data_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_record_pattern_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_record_data_get_next_record_pattern(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "record_pattern(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_record_pattern_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "date_time: ";

                field = iodef_record_data_get_date_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                iodef_application_t *field;

                field = iodef_record_data_get_application(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "application:\n", sizeof("application:\n") - 1);
                        iodef_application_print(field, fd);
                }
        }

        {
                char buf[128];
                iodef_record_item_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_record_data_get_next_record_item(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "record_item(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_record_item_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_record_data_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_record_data_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_record_print:
 * @ptr: Pointer to an iodef_record_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_record_print(iodef_record_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_record_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_record_get_next_record_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "record_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_record_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_record_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_record_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_reference_print:
 * @ptr: Pointer to an iodef_reference_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_reference_print(iodef_reference_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_reference_get_next_url(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "url(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_reference_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "reference_name: ";

                field = iodef_reference_get_reference_name(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_method_print:
 * @ptr: Pointer to an iodef_method_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_method_print(iodef_method_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_additional_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_method_get_next_additional_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "additional_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_additional_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_method_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_reference_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_method_get_next_reference(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "reference(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_reference_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_method_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_method_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_time_impact_print:
 * @ptr: Pointer to an iodef_time_impact_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_time_impact_print(iodef_time_impact_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_metric: ";

                field = iodef_time_impact_get_ext_metric(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_time_impact_get_duration(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "duration: ", sizeof("duration: ") - 1);
                        print_enum(iodef_time_impact_duration_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_time_impact_get_metric(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "metric: ", sizeof("metric: ") - 1);
                        print_enum(iodef_time_impact_metric_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_time_impact_get_severity(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "severity: ", sizeof("severity: ") - 1);
                        print_enum(iodef_time_impact_severity_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_duration: ";

                field = iodef_time_impact_get_ext_duration(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_impact_print:
 * @ptr: Pointer to an iodef_impact_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_impact_print(iodef_impact_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_impact_get_lang(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "lang: ", sizeof("lang: ") - 1);
                        print_enum(iodef_impact_lang_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_impact_get_completion(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "completion: ", sizeof("completion: ") - 1);
                        print_enum(iodef_impact_completion_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_impact_get_type(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "type: ", sizeof("type: ") - 1);
                        print_enum(iodef_impact_type_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_impact_get_severity(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "severity: ", sizeof("severity: ") - 1);
                        print_enum(iodef_impact_severity_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_type: ";

                field = iodef_impact_get_ext_type(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_confidence_print:
 * @ptr: Pointer to an iodef_confidence_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_confidence_print(iodef_confidence_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_confidence_get_rating(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "rating: ", sizeof("rating: ") - 1);
                        print_enum(iodef_confidence_rating_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_monetary_impact_print:
 * @ptr: Pointer to an iodef_monetary_impact_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_monetary_impact_print(iodef_monetary_impact_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                libiodef_string_t *field;
                const char tmp[] = "currency: ";

                field = iodef_monetary_impact_get_currency(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_monetary_impact_get_severity(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "severity: ", sizeof("severity: ") - 1);
                        print_enum(iodef_monetary_impact_severity_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_counter_print:
 * @ptr: Pointer to an iodef_counter_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_counter_print(iodef_counter_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_counter_get_duration(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "duration: ", sizeof("duration: ") - 1);
                        print_enum(iodef_counter_duration_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_counter_get_type(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "type: ", sizeof("type: ") - 1);
                        print_enum(iodef_counter_type_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_duration: ";

                field = iodef_counter_get_ext_duration(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_type: ";

                field = iodef_counter_get_ext_type(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_assessment_print:
 * @ptr: Pointer to an iodef_assessment_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_assessment_print(iodef_assessment_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_impact_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_assessment_get_next_impact(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "impact(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_impact_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_additional_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_assessment_get_next_additional_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "additional_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_additional_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_confidence_t *field;

                field = iodef_assessment_get_confidence(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "confidence:\n", sizeof("confidence:\n") - 1);
                        iodef_confidence_print(field, fd);
                }
        }

        {
                char buf[128];
                iodef_time_impact_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_assessment_get_next_time_impact(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "time_impact(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_time_impact_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_monetary_impact_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_assessment_get_next_monetary_impact(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "monetary_impact(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_monetary_impact_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_counter_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_assessment_get_next_counter(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "counter(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_counter_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_assessment_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_assessment_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_assessment_get_occurrence(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "occurrence: ", sizeof("occurrence: ") - 1);
                        print_enum(iodef_assessment_occurrence_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_service_print:
 * @ptr: Pointer to an iodef_service_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_service_print(iodef_service_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                uint32_t *field;
                const char tmp[] = "proto_code: ";

                field = iodef_service_get_proto_code(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_uint32(*field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                uint32_t *field;
                const char tmp[] = "proto_flags: ";

                field = iodef_service_get_proto_flags(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_uint32(*field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "portlist: ";

                field = iodef_service_get_portlist(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                iodef_application_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_service_get_next_application(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "application(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_application_print(elem, fd);

                        cnt++;
                }
        }

        {
                uint32_t *field;
                const char tmp[] = "proto_type: ";

                field = iodef_service_get_proto_type(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_uint32(*field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                uint32_t *field;
                const char tmp[] = "port: ";

                field = iodef_service_get_port(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_uint32(*field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                uint32_t *field;
                const char tmp[] = "ip_protocol: ";

                field = iodef_service_get_ip_protocol(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_uint32(*field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_address_print:
 * @ptr: Pointer to an iodef_address_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_address_print(iodef_address_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_address_get_category(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "category: ", sizeof("category: ") - 1);
                        print_enum(iodef_address_category_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "vlan_name: ";

                field = iodef_address_get_vlan_name(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_category: ";

                field = iodef_address_get_ext_category(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "vlan_num: ";

                field = iodef_address_get_vlan_num(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_node_role_print:
 * @ptr: Pointer to an iodef_node_role_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_node_role_print(iodef_node_role_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                int i = iodef_node_role_get_category(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "category: ", sizeof("category: ") - 1);
                        print_enum(iodef_node_role_category_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_node_role_get_lang(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "lang: ", sizeof("lang: ") - 1);
                        print_enum(iodef_node_role_lang_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_category: ";

                field = iodef_node_role_get_ext_category(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_node_print:
 * @ptr: Pointer to an iodef_node_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_node_print(iodef_node_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_node_get_next_node_name(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "node_name(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_counter_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_node_get_next_counter(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "counter(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_counter_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "date_time: ";

                field = iodef_node_get_date_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                iodef_node_role_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_node_get_next_node_role(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "node_role(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_node_role_print(elem, fd);

                        cnt++;
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "location: ";

                field = iodef_node_get_location(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                iodef_address_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_node_get_next_address(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "address(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_address_print(elem, fd);

                        cnt++;
                }
        }

        indent -= 8;
}

/**
 * iodef_operating_system_print:
 * @ptr: Pointer to an iodef_operating_system_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_operating_system_print(iodef_operating_system_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                libiodef_string_t *field;
                const char tmp[] = "url: ";

                field = iodef_operating_system_get_url(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "vendor: ";

                field = iodef_operating_system_get_vendor(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "name: ";

                field = iodef_operating_system_get_name(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "family: ";

                field = iodef_operating_system_get_family(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "swid: ";

                field = iodef_operating_system_get_swid(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "patch: ";

                field = iodef_operating_system_get_patch(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "version: ";

                field = iodef_operating_system_get_version(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "configid: ";

                field = iodef_operating_system_get_configid(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_system_print:
 * @ptr: Pointer to an iodef_system_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_system_print(iodef_system_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                iodef_node_t *field;

                field = iodef_system_get_node(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "node:\n", sizeof("node:\n") - 1);
                        iodef_node_print(field, fd);
                }
        }

        {
                char buf[128];
                iodef_additional_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_system_get_next_additional_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "additional_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_additional_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_system_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_service_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_system_get_next_service(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "service(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_service_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_counter_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_system_get_next_counter(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "counter(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_counter_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_operating_system_t *field;

                field = iodef_system_get_operating_system(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "operating_system:\n", sizeof("operating_system:\n") - 1);
                        iodef_operating_system_print(field, fd);
                }
        }

        {
                int i = iodef_system_get_category(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "category: ", sizeof("category: ") - 1);
                        print_enum(iodef_system_category_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_system_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_system_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_category: ";

                field = iodef_system_get_ext_category(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_system_get_spoofed(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "spoofed: ", sizeof("spoofed: ") - 1);
                        print_enum(iodef_system_spoofed_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "interface: ";

                field = iodef_system_get_interface(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_flow_print:
 * @ptr: Pointer to an iodef_flow_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_flow_print(iodef_flow_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_system_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_flow_get_next_system(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "system(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_system_print(elem, fd);

                        cnt++;
                }
        }

        indent -= 8;
}

/**
 * iodef_event_data_print:
 * @ptr: Pointer to an iodef_event_data_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_event_data_print(iodef_event_data_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                iodef_time_t *field;
                const char tmp[] = "detect_time: ";

                field = iodef_event_data_get_detect_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                iodef_additional_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_event_data_get_next_additional_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "additional_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_additional_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_event_data_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_flow_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_event_data_get_next_flow(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "flow(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_flow_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_expectation_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_event_data_get_next_expectation(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "expectation(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_expectation_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_record_t *field;

                field = iodef_event_data_get_record(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "record:\n", sizeof("record:\n") - 1);
                        iodef_record_print(field, fd);
                }
        }

        {
                char buf[128];
                iodef_contact_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_event_data_get_next_contact(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "contact(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_contact_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "start_time: ";

                field = iodef_event_data_get_start_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                iodef_event_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_event_data_get_next_event_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "event_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_event_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "end_time: ";

                field = iodef_event_data_get_end_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                iodef_assessment_t *field;

                field = iodef_event_data_get_assessment(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "assessment:\n", sizeof("assessment:\n") - 1);
                        iodef_assessment_print(field, fd);
                }
        }

        {
                char buf[128];
                iodef_method_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_event_data_get_next_method(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "method(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_method_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_event_data_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_event_data_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_incident_print:
 * @ptr: Pointer to an iodef_incident_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_incident_print(iodef_incident_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                iodef_time_t *field;
                const char tmp[] = "detect_time: ";

                field = iodef_incident_get_detect_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                iodef_additional_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_incident_get_next_additional_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "additional_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_additional_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "end_time: ";

                field = iodef_incident_get_end_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                libiodef_string_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_incident_get_next_description(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "description(%d): ", cnt);
                        libiodef_io_write(fd, buf, len);
                        print_string(elem, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_contact_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_incident_get_next_contact(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "contact(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_contact_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_alternative_id_t *field;

                field = iodef_incident_get_alternative_id(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "alternative_id:\n", sizeof("alternative_id:\n") - 1);
                        iodef_alternative_id_print(field, fd);
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "report_time: ";

                field = iodef_incident_get_report_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                iodef_time_t *field;
                const char tmp[] = "start_time: ";

                field = iodef_incident_get_start_time(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_time(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                char buf[128];
                iodef_event_data_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_incident_get_next_event_data(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "event_data(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_event_data_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_related_activity_t *field;

                field = iodef_incident_get_related_activity(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "related_activity:\n", sizeof("related_activity:\n") - 1);
                        iodef_related_activity_print(field, fd);
                }
        }

        {
                iodef_incident_id_t *field;

                field = iodef_incident_get_incident_id(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "incident_id:\n", sizeof("incident_id:\n") - 1);
                        iodef_incident_id_print(field, fd);
                }
        }

        {
                char buf[128];
                iodef_assessment_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_incident_get_next_assessment(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "assessment(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_assessment_print(elem, fd);

                        cnt++;
                }
        }

        {
                char buf[128];
                iodef_method_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_incident_get_next_method(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "method(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_method_print(elem, fd);

                        cnt++;
                }
        }

        {
                iodef_history_t *field;

                field = iodef_incident_get_history(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, "history:\n", sizeof("history:\n") - 1);
                        iodef_history_print(field, fd);
                }
        }

        {
                int i = iodef_incident_get_lang(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "lang: ", sizeof("lang: ") - 1);
                        print_enum(iodef_incident_lang_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_incident_get_restriction(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "restriction: ", sizeof("restriction: ") - 1);
                        print_enum(iodef_incident_restriction_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "ext_purpose: ";

                field = iodef_incident_get_ext_purpose(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                int i = iodef_incident_get_purpose(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "purpose: ", sizeof("purpose: ") - 1);
                        print_enum(iodef_incident_purpose_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}

/**
 * iodef_document_print:
 * @ptr: Pointer to an iodef_document_t object.
 * @fd: Pointer to a #libiodef_io_t object where to print @ptr to.
 *
 * This function will convert @ptr to a string suitable for writing,
 * and write it to the provided @fd descriptor.
 */
void iodef_document_print(iodef_document_t *ptr, libiodef_io_t *fd)
{
        if ( ! ptr )
                return;

        indent += 8;

        {
                char buf[128];
                iodef_incident_t *elem = NULL;
                int cnt = 0, len;

                while ( (elem = iodef_document_get_next_incident(ptr, elem)) ) {
                        print_indent(fd);

                        len = snprintf(buf, sizeof(buf), "incident(%d): \n", cnt);
                        libiodef_io_write(fd, buf, len);
                        iodef_incident_print(elem, fd);

                        cnt++;
                }
        }

        {
                int i = iodef_document_get_lang(ptr);



                {
                        print_indent(fd);
                        libiodef_io_write(fd, "lang: ", sizeof("lang: ") - 1);
                        print_enum(iodef_document_lang_to_string(i), i, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "formatid: ";

                field = iodef_document_get_formatid(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        {
                libiodef_string_t *field;
                const char tmp[] = "version: ";

                field = iodef_document_get_version(ptr);

                if ( field ) {
                        print_indent(fd);
                        libiodef_io_write(fd, tmp, sizeof(tmp) - 1);
                        print_string(field, fd);
                        libiodef_io_write(fd, "\n", sizeof("\n") - 1);
                }
        }

        indent -= 8;
}
